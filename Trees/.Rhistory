for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=14
for(b in c(2,4,8,12,14)){
counts2=counts2+1
if(b<=4){a<-sum(sim1[b]+sim1[b-1])}
if(b>4){a<-sum(sim1[b]+sim1[b-1]+sim1[b-2]+sim1[b-3])}
if(b==14){a<-sum(sim1[b]+sim1[b-1])}
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var(temperature)","andes","d13c","sealevel","var(sealevel)"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tyranni (Alternate sampling)") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","var temperature","sealevel","var sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=2
for(b in c(2,4,6,8,10,12,14)){
counts2=counts2+1
a<-sum(sim1[b]+sim1[b-1])
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var temperature","andes","sealevel","var sealevel"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tyranni (Alternate sampling)") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
get_model_table(tree,f=1,df=100,root_age=18.8221,outfile="env_bd_model_test_results_crown_f1_df100.csv", cond="crown")
get_model_table(tree,f=0.95,df=100,root_age=15.5731,outfile="env_bd_model_test_results_crown_f0.95_df100.csv", cond="crown")
get_model_table(tree,f=0.9,df=100,root_age=15.5731,outfile="env_bd_model_test_results_crown_f0.9_df100.csv", cond="crown")
get_model_table(tree,f=0.85,df=100,root_age=15.5731,outfile="env_bd_model_test_results_crown_f0.85_df100.csv", cond="crown")
get_model_table(tree,f=0.8,df=100,root_age=15.5731,outfile="env_bd_model_test_results_crown_f0.8_df100.csv", cond="crown")
####Combine results into single table
t1<-read.csv("env_bd_model_test_results_crown_f1_df100.csv",header=T)
f<-replicate(14,1.0)
t1<-cbind(f,t1)
t2<-read.csv("env_bd_model_test_results_crown_f0.95_df100.csv",header=T)
f<-replicate(14,0.95)
t2<-cbind(f,t2)
t3<-read.csv("env_bd_model_test_results_crown_f0.9_df100.csv",header=T)
f<-replicate(14,0.9)
t3<-cbind(f,t3)
t4<-read.csv("env_bd_model_test_results_crown_f0.85_df100.csv",header=T)
f<-replicate(14,0.85)
t4<-cbind(f,t4)
t5<-read.csv("env_bd_model_test_results_crown_f0.8_df100.csv",header=T)
f<-replicate(14,0.8)
t5<-cbind(f,t5)
all1<-rbind(t1,t2,t3,t4,t5)
write.csv(all1,"env_bd_model_test_results_crown_f0.8-1_df100.csv")
t1<-read.csv("env_bd_model_test_results_crown_f0.8-1_df100.csv",header=T)
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=14
for(b in c(2,4,8,12,14)){
counts2=counts2+1
if(b<=4){a<-sum(sim1[b]+sim1[b-1])}
if(b>4){a<-sum(sim1[b]+sim1[b-1]+sim1[b-2]+sim1[b-3])}
if(b==14){a<-sum(sim1[b]+sim1[b-1])}
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var(temperature)","andes","d13c","sealevel","var(sealevel)"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tyranni (Alternate sampling)") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","var temperature","sealevel","var sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=2
for(b in c(2,4,6,8,10,12,14)){
counts2=counts2+1
a<-sum(sim1[b]+sim1[b-1])
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var temperature","andes","sealevel","var sealevel"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tyranni (Alternate sampling)") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
get_model_table(tree,f=1,df=100,root_age=18.8221,outfile="env_bd_model_test_results_stem_f1_df100.csv", cond="stem")
get_model_table(tree,f=0.95,df=100,root_age=15.5731,outfile="env_bd_model_test_results_stem_f0.95_df100.csv", cond="stem")
get_model_table(tree,f=0.9,df=100,root_age=15.5731,outfile="env_bd_model_test_results_stem_f0.9_df100.csv", cond="stem")
get_model_table(tree,f=0.85,df=100,root_age=15.5731,outfile="env_bd_model_test_results_stem_f0.85_df100.csv", cond="stem")
get_model_table(tree,f=0.8,df=100,root_age=15.5731,outfile="env_bd_model_test_results_stem_f0.8_df100.csv", cond="stem")
####Combine results into single table
t1<-read.csv("env_bd_model_test_results_stem_f1_df100.csv",header=T)
f<-replicate(14,1.0)
t1<-cbind(f,t1)
t2<-read.csv("env_bd_model_test_results_stem_f0.95_df100.csv",header=T)
f<-replicate(14,0.95)
t2<-cbind(f,t2)
t3<-read.csv("env_bd_model_test_results_stem_f0.9_df100.csv",header=T)
f<-replicate(14,0.9)
t3<-cbind(f,t3)
t4<-read.csv("env_bd_model_test_results_stem_f0.85_df100.csv",header=T)
f<-replicate(14,0.85)
t4<-cbind(f,t4)
t5<-read.csv("env_bd_model_test_results_stem_f0.8_df100.csv",header=T)
f<-replicate(14,0.8)
t5<-cbind(f,t5)
all1<-rbind(t1,t2,t3,t4,t5)
write.csv(all1,"env_bd_model_test_results_stem_f0.8-1_df100.csv")
t1<-read.csv("env_bd_model_test_results_stem_f0.8-1_df100.csv",header=T)
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=14
for(b in c(2,4,8,12,14)){
counts2=counts2+1
if(b<=4){a<-sum(sim1[b]+sim1[b-1])}
if(b>4){a<-sum(sim1[b]+sim1[b-1]+sim1[b-2]+sim1[b-3])}
if(b==14){a<-sum(sim1[b]+sim1[b-1])}
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var(temperature)","andes","d13c","sealevel","var(sealevel)"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tinamous") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","var temperature","sealevel","var sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=2
for(b in c(2,4,6,8,10,12,14)){
counts2=counts2+1
a<-sum(sim1[b]+sim1[b-1])
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var temperature","andes","sealevel","var sealevel"))
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tinamous") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
t1<-read.csv("env_bd_model_test_results_stem_f0.8-1_df100.csv",header=T)
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=14
for(b in c(2,4,8,12,14)){
counts2=counts2+1
if(b<=4){a<-sum(sim1[b]+sim1[b-1])}
if(b>4){a<-sum(sim1[b]+sim1[b-1]+sim1[b-2]+sim1[b-3])}
if(b==14){a<-sum(sim1[b]+sim1[b-1])}
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var(temperature)","andes","d13c","sealevel","var(sealevel)"))
pdf("./RPANDA_14models_5categroies_f0.5-1_sf100_with_extinction.pdf",width = 8,height = 8)
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tinamous") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
dev.off()
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","var temperature","sealevel","var sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=2
for(b in c(2,4,6,8,10,12,14)){
counts2=counts2+1
a<-sum(sim1[b]+sim1[b-1])
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var temperature","andes","sealevel","var sealevel"))
pdf("./RPANDA_14models_7categroies_f0.5-1_sf100_with_extinction.pdf",width = 8,height = 8)
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("Tinamous") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
dev.off()
setwd("~/Documents/ANSDU/Toucan_barbets/")
library(RPANDA)
library(phytools)
library(ggplot2)
read.nexus("SameTreeNoOut.tre")->tree
t1<-read.csv("env_bd_model_test_results_f0.8-1_df100.csv",header=T)
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=14
for(b in c(2,4,8,12,14)){
counts2=counts2+1
if(b<=4){a<-sum(sim1[b]+sim1[b-1])}
if(b>4){a<-sum(sim1[b]+sim1[b-1]+sim1[b-2]+sim1[b-3])}
if(b==14){a<-sum(sim1[b]+sim1[b-1])}
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var(temperature)","andes","d13c","sealevel","var(sealevel)"))
pdf("~/Documents/ANSDU/Toucan_barbets/RPANDA_14models_5categroies_f0.5-1_sf100_with_extinction.pdf",width = 8,height = 8)
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("NW Ramphastides") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
dev.off()
collapse_mods2<-function(file){
model_names<-c("constant","time-dependent","temperature","var temperature","sealevel","var sealevel","andes")
count=0
for (j in 1:length(unique(file[,2]))){
count=count+1
max.weights<-c()
sim1<-file$weights[file$f==unique(file[,2])[j]]
new.sim1<-c()
counts2=0
b=2
for(b in c(2,4,6,8,10,12,14)){
counts2=counts2+1
a<-sum(sim1[b]+sim1[b-1])
new.sim1[counts2]<-a
tab<-cbind(unique(file[,2])[j],model_names,new.sim1)
}
if (count==1){
tab2<-tab
}
if (count>1){
tab2<-rbind(tab2,tab)
}
}
return(tab2)
}
t<-collapse_mods2(t1)
f<-as.numeric(t[,1])
model_names<-t[,2]
AICw<-as.numeric(t[,3])
data<-as.data.frame(cbind(f,model_names,AICw))
sum(as.numeric(data$AICw[data$f=="1"]))
data$f<-factor(data$f, levels = c("1","0.95","0.9","0.85","0.8"))
data$model_names<-factor(data$model_names, levels = c("constant","time-dependent","temperature","var temperature","andes","sealevel","var sealevel"))
pdf("~/Documents/ANSDU/Toucan_barbets/RPANDA_14models_7categroies_f0.5-1_sf100_with_extinction.pdf",width = 8,height = 8)
ggplot(data, aes(fill=model_names, y=as.numeric(AICw), x=f)) +
geom_bar(position="stack", stat="identity") +
scale_fill_brewer(type = "seq",palette = "RdYlBu") +
ggtitle("NW Ramphastides") +
#theme_ipsum() +
xlab("Assumed Sampling Fraction (f)")+
ylab("AICw")
dev.off()
install.packages("treeducken")
library(treeducken)
library(ape)
setwd("~/Documents/ANSDU/Tinamous/Trees/")
t<-read.tree(file = "UCE.100flank.complete.ASTRAL.PP.tre")
sim_msc(species_tree = t,ne = 500000,num_sampled_individuals = 1, num_genes = 4000,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
class(t)
sim_msc(species_tree = t,ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims<-sim_msc(species_tree = t,ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims
sims<-sim_msc(species_tree = t[[1]],ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims
t[[1]]
tr <- sim_stBD(sbr = lambda, sdr = mu, numbsim = 1, n_tips = nt)
tr
library(treeducken)
library(ape)
setwd("~/Documents/ANSDU/Tinamous/Trees/")
t<-read.tree(file = "UCE.100flank.complete.ASTRAL.PP.tre")
t
class(t)
sims<-sim_msc(species_tree = t[[1]],ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims
tr <- sim_stBD(sbr = lambda, sdr = mu, numbsim = 1, n_tips = nt)
?sim_stBD
tr <- sim_stBD(sbr = lambda, sdr = mu, numbsim = 1, n_tips = nt)
tr
detach("package:ape", unload = TRUE)
setwd("~/Documents/ANSDU/Tinamous/Trees/")
tr <- sim_stBD(sbr = lambda, sdr = mu, numbsim = 1, n_tips = nt)
tr
library(treeducken)
t<-read.tree(file = "UCE.100flank.complete.ASTRAL.PP.tre")
t
t<-read.tree(file = "UCE.100flank.complete.ASTRAL.PP.tre")
t
t$tip.label
sims<-sim_msc(species_tree = root(t,"Rhea_penn_GCA_003342835"),ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims
detach("package:RPANDA", unload = TRUE)
sims<-sim_msc(species_tree = root(t,"Rhea_penn_GCA_003342835"),ne = 500000,num_sampled_individuals = 1, num_genes = 40,rescale = F, mutation_rate = 4.26E-9,generation_time = 2)
sims
