break1 <- round(my.seg$psi[, 2])
c0 <- b0 + b1 * break1 - c1 * break1
d1 <- coef(my.seg)[[4]] + c1
break_point <- round(my.seg$psi[, 2])
ggplot(data, aes(x = m, y = likelihood)) +
geom_point(size=2) + theme_classic() +
scale_x_continuous(labels=as.character(data$number_of_max_reticulations), breaks=data$number_of_max_reticulations) +
geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +
geom_vline(xintercept=break_point, linetype='dashed') +
geom_abline(intercept = b0, slope = b1, aes(colour = "first part"), show.legend = TRUE) +
geom_abline(intercept = c0, slope = c1, aes(colour = "second part"), show.legend = TRUE)
df.all
trees
setwd("/Users/lukasmusher/Documents/ANSDU/Tinamous/RF.distances/alignments_uce-1000flank-complete-nexus/")
setwd("/Users/lukasmusher/Documents/ANSDU/Tinamous/RF.distances/alignments_uce-1000flank-complete-nexus/")
files <- list.files(path="./", pattern="*.nexus", full.names=F, recursive=FALSE)
trees.coll <- list.files(path="./",pattern="*.collapsed.tre",full.names=F,recursive=FALSE)
trees <- list.files(path="./",pattern="*.treefile",full.names=F,recursive=FALSE)
length(trees)
trees.coll
trees
trees <- list.files(path="./",pattern="*2.treefile",full.names=F,recursive=FALSE)
trees
length(trees)
for (i in 1:length(trees.coll))
i=1
trees.coll[i]
tree<-read.tree(trees.coll[i])
plot(tree)
tree<-root(tree,"Rhea_penn_GCA_003342835")
plot(tree)
tree<-root(tree,"Rhea_penn_GCA_003342835", resolve.root = T)
plot(tree)
tree<-read.tree(trees.coll[i])
tree<-root(tree,"Rhea_penn_GCA_003342835", resolve.root = T)
plot(tree)
tree$tip.label
is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915"))
tree
trees.coll[i]
aln<-c()
tree.mon<-c()
!(is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915")))
is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915"))
aln<-c()
tree.mon<-c()
for (i in 1:length(trees.coll)){
aln[i]<-trees.coll[i]
tree<-read.tree(trees.coll[i])
if(is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915"))){
tree.mon[i]<-1
}
if(!(is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915")))){
tree.mon[i]<-0
}
}
df.uce1000<-cbind(df.uce1000,tree.mon)
plot(df.uce1000$pars.site,df.uce1000$tree.mon)
model <- glm(tree.mon ~ pars.site, data=df.uce1000, family = "binomial")
summary(model)
model <- glm(tree.mon ~ $pars.site.prop, data=df.uce1000, family = "binomial")
model <- glm(tree.mon ~ pars.site.prop, data=df.uce1000, family = "binomial")
summary(model)
plot(df.uce1000$pars.site.prop,df.uce1000$tree.mon)
setwd("/Users/lukasmusher/Documents/ANSDU/Tinamous/RF.distances/alignments_uce-300flank-complete-nexus/")
trees.coll <- list.files(path="./",pattern="*.collapsed.tre",full.names=F,recursive=FALSE)
length(trees.coll)
aln<-c()
tree.mon<-c()
for (i in 1:length(trees.coll)){
aln[i]<-trees.coll[i]
tree<-read.tree(trees.coll[i])
if(is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915"))){
tree.mon[i]<-1
}
if(!(is.monophyletic(tree,c("CryUnd_GCA_013389825","Ceery21146","Crdui419412","Crker147057","Ccgol2213","Ctra66583","Cstr9577","CryCin_GCA_003342915")))){
tree.mon[i]<-0
}
}
df.uce300<-cbind(df.uce300,tree.mon)
plot(df.uce300$pars.site.prop,df.uce300$tree.mon)
plot(df.uce300$pars.site,df.uce300$tree.mon)
model <- glm(tree.mon ~ pars.site.prop, data=df.uce300, family = "binomial")
summary(model)
model <- glm(tree.mon ~ pars.site, data=df.uce300, family = "binomial")
summary(model)
z = ggplot(df.uce300,aes(x=pars.site,y=tree.mon)) +
geom_point() + stat_smooth(colour="red", method="glm",se=TRUE, method.args = list(family=binomial))+
ggtitle("Chromosome topology", subtitle = paste("p = ",round(coef(summary(model))[2,4],digits = 3),sep = ""))+
theme_bw() + xlab("sqrt(Chromosome Length)") + ylab("Rondonia == monophyletic")
z
df.uce300<-cbind(df.uce1000,tree.mon)
plot(df.uce1000$pars.site.prop,df.uce1000$tree.mon)
model <- glm(tree.mon ~ pars.site.prop, data=df.uce300, family = "binomial")
z = ggplot(df.uce1000,aes(x=pars.site,y=tree.mon)) +
geom_point() + stat_smooth(colour="red", method="glm",se=TRUE, method.args = list(family=binomial))+
ggtitle("Chromosome topology", subtitle = paste("p = ",round(coef(summary(model))[2,4],digits = 3),sep = ""))+
theme_bw() + xlab("sqrt(Chromosome Length)") + ylab("Rondonia == monophyletic")
z
z = ggplot(df.uce1000,aes(x=pars.site.prop,y=tree.mon)) +
geom_point() + stat_smooth(colour="red", method="glm",se=TRUE, method.args = list(family=binomial))+
ggtitle("Chromosome topology", subtitle = paste("p = ",round(coef(summary(model))[2,4],digits = 3),sep = ""))+
theme_bw() + xlab("sqrt(Chromosome Length)") + ylab("Rondonia == monophyletic")
z
plot(df.uce300$pars.site,df.uce300$tree.mon)
model <- glm(tree.mon ~ pars.site, data=df.uce300, family = "binomial")
summary(model)
model <- glm(tree.mon ~ pars.site, data=df.uce1000, family = "binomial")
summary(model)
model <- glm(tree.mon ~ pars.site.prop, data=df.uce1000, family = "binomial")
summary(model)
#p = 0.0536
#odds ratio:
exp(1.4792) #0.9997337
z = ggplot(df.uce300,aes(x=pars.site,y=tree.mon)) +
geom_point() + stat_smooth(colour="red", method="glm",se=TRUE, method.args = list(family=binomial))+
ggtitle("Chromosome topology", subtitle = paste("p = ",round(coef(summary(model))[2,4],digits = 3),sep = ""))+
theme_bw() + xlab("sqrt(Chromosome Length)") + ylab("Rondonia == monophyletic")
z
plot(df.uce300$rf.distance.coll,df.uce300$tree.mon)
model <- glm(tree.mon ~ rf.distance.coll, data=df.uce1000, family = "binomial")
summary(model)
z = ggplot(df.uce300,aes(x=rf.distance.coll,y=tree.mon)) +
geom_point() + stat_smooth(colour="red", method="glm",se=TRUE, method.args = list(family=binomial))+
ggtitle("Chromosome topology", subtitle = paste("p = ",round(coef(summary(model))[2,4],digits = 3),sep = ""))+
theme_bw() + xlab("sqrt(Chromosome Length)") + ylab("Rondonia == monophyletic")
z
plot(df.uce300$gc.cont,df.uce300$tree.mon)
model <- glm(tree.mon ~ gc.cont, data=df.uce1000, family = "binomial")
summary(model)
plot(df.uce300$chrom,df.uce300$tree.mon)
model <- glm(tree.mon ~ chrom, data=df.uce1000, family = "binomial")
summary(model)
cfs
pairwise.wilcox.test(cfs$gCF[cfs$Method=="astral"], cfs$Dataset[cfs$Method=="astral"], p.adjust.method = "hochberg")
kruskal.test(cfs$gCF[cfs$Method=="astral"]~cfs$Dataset[cfs$Method=="iqtree"])
cfs$Method
astral
kruskal.test(cfs$gCF[cfs$Method=="astral"]~cfs$Dataset[cfs$Method=="astral"])
kruskal.test(cfs$gCF[cfs$Dataset=="uce 1000"]~cfs$Method[cfs$Dataset=="uce 1000"])
cfs$Method[cfs$Dataset=="uce 1000"]
cfs$Dataset
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Method[cfs$Dataset=="UCE1000Flank"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Method[cfs$Dataset=="UCE1000Flank"])
mean(cfs$gCF[cfs$Dataset=="astral" & cfs$Method=="iqtree"])
mean(cfs$gCF[cfs$Dataset=="astral" & cfs$Method=="iqtree",])
cfs$Dataset=="astral"
cfs$Method=="iqtree"
cfs$gCF[cfs$Dataset=="astral" & cfs$Method=="iqtree"]
cfs$gCF[cfs$Dataset=="astral" & cfs$Method=="iqtree",]
mean(cfs$gCF[cfs$Dataset=="astral" && cfs$Method=="iqtree",])
cfs$Method=="iqtree"
cfs$Dataset=="astral" & cfs$Method=="iqtree"
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree",])
cfs$Dataset=="UCE1000Flank"
cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree"
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree"])
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"])
cfs$Method
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"])
cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"]
###Concordance factors boxplots
setwd("~/Documents/ANSDU/Tinamous/concordance_factors/")
cfs<-read.csv("CFS.all.datasets.csv")
cfs$Dataset<-factor(cfs$Dataset, levels = c("BUSCOs","UCE100Flank", "UCE300Flank", "UCE1000Flank"))
kruskal.test(cfs$gCF[cfs$Dataset=="astral"]~cfs$Dataset[cfs$Method=="astral"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Method[cfs$Dataset=="UCE1000Flank"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Dataset[cfs$Method=="astral"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Dataset[cfs$Method=="astral"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Method[cfs$Dataset=="UCE1000Flank"])
cfs$Method
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree"])
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"])
cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"]
mean(na.omit(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"]))
cfs<-na.omit(read.csv("CFS.all.datasets.csv"))
cfs$Dataset<-factor(cfs$Dataset, levels = c("BUSCOs","UCE100Flank", "UCE300Flank", "UCE1000Flank"))
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Dataset[cfs$Method=="astral"])
cfs$Dataset=="UCE1000Flank"
kruskal.test(cfs$gCF[cfs$Method=="astral"]~cfs$Dataset[cfs$Method=="astral"])
kruskal.test(cfs$gCF[cfs$Dataset=="UCE1000Flank"]~cfs$Method[cfs$Dataset=="UCE1000Flank"])
mean(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree"])
mean(na.omit(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"]))
hist(na.omit(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="astral"]))
hist(cfs$gCF[cfs$Dataset=="UCE1000Flank" & cfs$Method=="iqtree"])
library(ggplot2)
library(gplots)
library(phytools)
library(ape)
library(phangorn)
library(ips)
library(ggpubr)
#set working directory
setwd("/Users/lukasmusher/Documents/ANSDU/Tinamous/RF.distances/CDS_complete_nexus/")
z.uces<-read.table("../../z.chrom.list.txt")$V1
df.uce100<-read.csv("../uce100.collapsed.csv")
for (i in 1:length(df.uce100$pars.site.prop)){
if (df.uce100$pars.site.prop[i]==0){
df.uce100$pars.site.prop[i]<-NA
}
}
sum(df.uce100$aln %in% z.uces)
chrom<-c()
for (i in 1:length(df.uce100$pars.site.prop)){
if (df.uce100$aln[i] %in% z.uces){
chrom[i]<-"Z-chromosome"
print("found Z")
}
if (!(df.uce100$aln[i] %in% z.uces)){
chrom[i]<-"Autosome"
}
}
df.uce100<-cbind(df.uce100,chrom)
sum(df.uce100$chrom=="Z-chromosome")
df.uce100<-na.omit(df.uce100)
df.uce100$pars.site.prop<-as.numeric(df.uce100$pars.site.prop)
fit.glm <- glm(rf.distance.coll~pars.site, data = df.uce100)
fit.glog <- glm(rf.distance.coll~log(pars.site), data = df.uce100)
summary(fit.glm) #AIC: 21684 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site, data = df.uce100)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.uce100)
summary(fit.lm) #AIC: 21684 Lowest AIC
summary(fit.log)
uce100.pis.plot2<-ggplot(df.uce100,aes(x=pars.site,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("UCE 100 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# informative sites") + ylab("RF Distance")+
geom_point(data=df.uce100[df.uce100$chrom=="Z-chromosome",], mapping =aes(x=pars.site, y=rf.distance.coll), color="yellow", size=1)
uce100.pis.plot2
fit.glm <- glm(rf.distance.coll~pars.site.prop, data = df.uce100)
fit.glog <- glm(rf.distance.coll~log(pars.site.prop), data = df.uce100)
summary(fit.glm) #AIC: 21525 Lowest AIC
summary(fit.glog) #AIC: 22119
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.uce100)
fit.log <- lm(rf.distance~log(pars.site.prop), data = df.uce100)
summary(fit.lm)
summary(fit.log)
uce100.prop.plot2<-ggplot(df.uce100,aes(x=pars.site.prop,y=rf.distance)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("UCE 100 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")+
geom_point(data=df.uce100[df.uce100$chrom=="Z-chromosome",], mapping =aes(x=pars.site.prop, y=rf.distance.coll), color="yellow", size=1)
uce100.prop.plot2
df.uce300<-read.csv("../uce300.collapsed.csv")
for (i in 1:length(df.uce300$pars.site.prop)){
if (df.uce300$pars.site.prop[i]==0){
df.uce300$pars.site.prop[i]<-NA
}
}
sum(df.uce300$aln %in% z.uces)
chrom<-c()
for (i in 1:length(df.uce300$pars.site.prop)){
if (df.uce300$aln[i] %in% z.uces){
chrom[i]<-"Z-chromosome"
print("found Z")
}
if (!(df.uce300$aln[i] %in% z.uces)){
chrom[i]<-"Autosome"
}
}
df.uce300<-cbind(df.uce300,chrom)
sum(df.uce300$chrom=="Z-chromosome")
plot(as.factor(df.uce300$chrom),df.uce300$rf.distance.coll)
df.uce300<-na.omit(df.uce300)
df.uce300$pars.site.prop<-as.numeric(df.uce300$pars.site.prop)
df.uce300
fit.glm <- glm(rf.distance.coll~pars.site, data = df.uce300)
fit.glog <- glm(rf.distance.coll~log(pars.site), data = df.uce300)
summary(fit.glm) #AIC: 21345
summary(fit.glog) #AIC: 20216 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site, data = df.uce300)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.uce300)
summary(fit.lm) #AIC: 21345
summary(fit.log)
uce300.pis.plot2<-ggplot(df.uce300,aes(x=pars.site,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~log(x), color="red")+
ggtitle("UCE 300 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.log)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# informative sites") + ylab("RF Distance")+
geom_point(data=df.uce300[df.uce300$chrom=="Z-chromosome",], mapping =aes(x=pars.site, y=rf.distance.coll), color="yellow", size=1)
uce300.pis.plot2
fit.glm <- glm(rf.distance.coll~pars.site.prop, data = df.uce300)
fit.glog <- glm(rf.distance.coll~log(pars.site.prop), data = df.uce300)
summary(fit.glm) #AIC: 21092
summary(fit.glog) #AIC: 20047 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site, data = df.uce300)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.uce300)
summary(fit.lm)
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.uce300)
fit.log <- lm(rf.distance.coll~log(pars.site.prop), data = df.uce300)
summary(fit.lm) #AIC: 21092
summary(fit.log) #AIC: 20047 Lowest AIC
uce300.prop.plot2<-ggplot(df.uce300,aes(x=pars.site.prop,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~log(x), color="red")+
ggtitle("UCE 300 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.log)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")+
geom_point(data=df.uce300[df.uce300$chrom=="Z-chromosome",], mapping =aes(x=pars.site.prop, y=rf.distance.coll), color="yellow", size=1)
uce300.prop.plot2
fit.glm <- glm(rf.distance.coll~gc.cont, data = df.uce300)
fit.glog <- glm(rf.distance.coll~log(gc.cont), data = df.uce300)
summary(fit.glm) #AIC: 22941 Lowest AIC
summary(fit.glog) #AIC: 22942
fit.lm <- lm(rf.distance.coll~gc.cont, data = df.uce300)
uce300.gc.plot2<-ggplot(df.uce300,aes(x=gc.cont,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("UCE 300 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("GC Content") + ylab("RF Distance")+
geom_point(data=df.uce300[df.uce300$chrom=="Z-chromosome",], mapping =aes(x=gc.cont, y=rf.distance.coll), color="yellow", size=1)
uce300.gc.plot2
df.uce1000<-read.csv("../uce1000.collapsed.csv")
for (i in 1:length(df.uce1000$pars.site.prop)){
if (df.uce1000$pars.site.prop[i]==0){
df.uce1000$pars.site.prop[i]<-NA
}
}
sum(df.uce1000$aln %in% z.uces)
chrom<-c()
for (i in 1:length(df.uce1000$pars.site.prop)){
if (df.uce1000$aln[i] %in% z.uces){
chrom[i]<-"Z-chromosome"
print("found Z")
}
if (!(df.uce1000$aln[i] %in% z.uces)){
chrom[i]<-"Autosome"
}
}
df.uce1000<-cbind(df.uce1000,chrom)
sum(df.uce1000$chrom=="Z-chromosome")
plot(as.factor(df.uce1000$chrom),df.uce1000$rf.distance.coll)
df.uce1000<-na.omit(df.uce1000)
df.uce1000$pars.site.prop<-as.numeric(df.uce1000$pars.site.prop)
fit.glm <- glm(rf.distance.coll~pars.site.prop, data = df.uce1000)
fit.glog <- glm(rf.distance~log(pars.site.prop), data = df.uce1000)
summary(fit.glm) #AIC: 18843 Lowest AIC
summary(fit.glog) #AIC: 19711
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.uce1000)
fit.log <- lm(rf.distance~log(pars.site.prop), data = df.uce1000)
summary(fit.lm) #AIC: 18843 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.uce1000)
fit.log <- lm(rf.distance~log(pars.site.prop), data = df.uce1000)
summary(fit.lm)
summary(fit.log)
uce1000.prop.plot2<-ggplot(df.uce1000,aes(x=pars.site.prop,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("UCE 1000 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")+
geom_point(data=df.uce1000[df.uce1000$chrom=="Z-chromosome",], mapping =aes(x=pars.site.prop, y=rf.distance.coll), color="yellow", size=1)
uce1000.prop.plot2
fit.glm <- glm(rf.distance.coll~pars.site, data = df.uce1000)
fit.glog <- glm(rf.distance.coll~log(pars.site), data = df.uce1000)
summary(fit.glm) #AIC: 18893
summary(fit.glog) #AIC: 18870 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site, data = df.uce1000)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.uce1000)
summary(fit.lm)
summary(fit.log)
uce1000.pis.plot2<-ggplot(df.uce1000,aes(x=pars.site,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~log(x), color="red")+
ggtitle("UCE 1000 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.log)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# informative sites") + ylab("RF Distance")+
geom_point(data=df.uce1000[df.uce1000$chrom=="Z-chromosome",], mapping =aes(x=pars.site, y=rf.distance.coll), color="yellow", size=1)
uce1000.pis.plot2
fit.glm <- glm(rf.distance.coll~gc.cont, data = df.uce1000)
fit.glog <- glm(rf.distance.coll~log(gc.cont), data = df.uce1000)
summary(fit.glm) #AIC: 18884 Lowest AIC
summary(fit.glog) #AIC: 18884
fit.lm <- lm(rf.distance.coll~gc.cont, data = df.uce1000)
uce1000.gc.plot2<-ggplot(df.uce1000,aes(x=gc.cont,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("UCE 1000 Flank", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("GC Content") + ylab("RF Distance")+
geom_point(data=df.uce1000[df.uce1000$chrom=="Z-chromosome",], mapping =aes(x=gc.cont, y=rf.distance.coll), color="yellow", size=1)
uce1000.gc.plot2
df.CDS<-read.csv("../CDS.collapsed.csv")
for (i in 1:length(df.CDS$pars.site.prop)){
if (df.CDS$pars.site.prop[i]==0){
df.CDS$pars.site.prop[i]<-NA
}
}
df.CDS<-na.omit(df.CDS)
df.CDS$pars.site.prop<-as.numeric(df.CDS$pars.site.prop)
df.CDS$pars.site<-as.numeric(df.CDS$pars.site)
df.CDS$rf.distance<-as.numeric(df.CDS$rf.distance)
fit.glm <- glm(rf.distance.coll~pars.site.prop, data = df.CDS)
fit.glog <- glm(rf.distance.coll~log(pars.site.prop), data = df.CDS)
summary(fit.glm) #AIC: 21177 Lowest AIC
summary(fit.glog) #AIC: 21189
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.CDS)
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.CDS)
fit.log <- lm(rf.distance.coll~log(pars.site.prop), data = df.CDS)
summary(fit.lm)
summary(fit.log)
CDS.prop.plot2<-ggplot(df.CDS,aes(x=pars.site.prop,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("CDS", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")
CDS.prop.plot2
fit.glm <- glm(rf.distance.coll~pars.site, data = df.CDS)
fit.glog <- glm(rf.distance.coll~log(pars.site), data = df.CDS)
summary(fit.glm) #AIC: 21179 Lowest AIC
summary(fit.glog) #AIC: 21179
fit.lm <- lm(rf.distance.coll~pars.site, data = df.CDS)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.CDS)
summary(fit.lm)
summary(fit.log)
CDS.pis.plot2<-ggplot(df.CDS,aes(x=pars.site,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("CDS", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# of informative sites") + ylab("RF Distance")
CDS.pis.plot2
fit.glm <- glm(rf.distance.coll~gc.cont, data = df.CDS)
fit.glog <- glm(rf.distance.coll~log(gc.cont), data = df.CDS)
summary(fit.glm) #AIC: 21234 Lowest AIC
summary(fit.glog) #AIC: 21234
fit.lm <- lm(rf.distance.coll~gc.cont, data = df.CDS)
CDS.gc.plot2<-ggplot(df.CDS,aes(x=gc.cont,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("CDS", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("GC Content") + ylab("RF Distance")
CDS.gc.plot2
####Combine UCEs###
dataset<-c(rep("uce 100", length(df.uce100[,1])),rep("uce 300", length(df.uce300[,1])),rep("uce 1000", length(df.uce1000[,1])))
df.uce<-rbind(df.uce100,df.uce300,df.uce1000)
df.uce<-cbind(dataset,df.uce)
fit.glm <- glm(rf.distance.coll~pars.site.prop, data = df.uce)
fit.glog <- glm(rf.distance.coll~log(pars.site.prop), data = df.uce)
summary(fit.glm) #AIC: 76049 Lowest AIC
summary(fit.glog) #AIC: 74480
fit.lm <-lm(rf.distance.coll~pars.site.prop, data = df.uce)
fit.lm <-lm(rf.distance.coll~pars.site.prop, data = df.uce)
fit.log <-lm(rf.distance.coll~log(pars.site.prop), data = df.uce)
fit.lm <-lm(rf.distance.coll~pars.site.prop, data = df.uce)
fit.log <-lm(rf.distance.coll~log(pars.site.prop), data = df.uce)
summary(fit.lm)
summary(fit.log)
uce.prop.plot2<-ggplot(df.uce,aes(x=pars.site.prop,y=rf.distance.coll, col=dataset)) +
geom_point(alpha=0.6) +
scale_color_manual(values = c("#ca7dcc",
"#1b98e0",
"#353436"))+
geom_smooth(method=lm, se = T ,formula = y~log(x), color="red")+
ggtitle("UCE 3 Datasets", subtitle = paste("Adj. R-squared = ",round(summary(fit.log)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")+
theme(legend.position = "none")+
geom_point(data=df.uce[df.uce$chrom=="Z-chromosome",], mapping =aes(x=pars.site.prop, y=rf.distance.coll), color="Yellow", size=1)
uce.prop.plot2
fit.glm <- glm(rf.distance.coll~pars.site, data = df.uce)
fit.glog <- glm(rf.distance.coll~log(pars.site), data = df.uce)
summary(fit.glm) #AIC: 80245
summary(fit.glog) #AIC: 69350 Lowest AIC
fit.lm <- lm(rf.distance.coll~pars.site, data = df.uce)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.uce)
summary(fit.lm)
summary(fit.log)
uce.pis.plot2<-ggplot(df.uce,aes(x=pars.site,y=rf.distance.coll, col=dataset)) +
geom_point(alpha=0.6) +
geom_smooth(method="lm", se = T ,formula = y~log(x), color="red")+
scale_color_manual(values = c("#ca7dcc",
"#1b98e0",
"#353436"))+
ggtitle("UCE 3 Datasets", subtitle = paste("Adj. R-squared = ",round(summary(fit.log)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.log))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# informative sites") + ylab("RF Distance")+
theme(legend.position = c(0.75,0.75),legend.background = element_rect(fill="white",
size=0.5, linetype="solid",
colour ="black"))+
geom_point(data=df.uce[df.uce$chrom=="Z-chromosome",], mapping =aes(x=pars.site, y=rf.distance.coll), color="yellow", size=1)
uce.pis.plot2
ggarrange(CDS.pis.plot2,uce100.pis.plot2,uce300.pis.plot2,uce1000.pis.plot2,uce.pis.plot2,
CDS.prop.plot2,uce100.prop.plot2,uce300.prop.plot2,uce1000.prop.plot2,uce.prop.plot2,
ncol = 5, nrow = 2)
CDS.prop.plot2<-ggplot(df.CDS,aes(x=pars.site.prop,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("BUSCOs", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")
fit.lm <- lm(rf.distance.coll~pars.site.prop, data = df.CDS)
fit.log <- lm(rf.distance.coll~log(pars.site.prop), data = df.CDS)
summary(fit.lm)
summary(fit.log)
CDS.prop.plot2<-ggplot(df.CDS,aes(x=pars.site.prop,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("BUSCOs", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("Proportion of informative sites") + ylab("RF Distance")
fit.lm <- lm(rf.distance.coll~pars.site, data = df.CDS)
fit.log <- lm(rf.distance.coll~log(pars.site), data = df.CDS)
summary(fit.lm)
summary(fit.log)
CDS.pis.plot2<-ggplot(df.CDS,aes(x=pars.site,y=rf.distance.coll)) +
geom_point(alpha=0.6) +
geom_smooth(method=lm, se = T ,formula = y~x, color="red")+
ggtitle("BUSCOs", subtitle = paste("Adj. R-squared = ",round(summary(fit.lm)$adj.r.squared,digits = 2), ", P = ",round(coef(summary(fit.lm))[2,4],digits = 4),sep = ""))+
theme_bw() + xlab("# of informative sites") + ylab("RF Distance")
CDS.pis.plot2
ggarrange(CDS.pis.plot2,uce100.pis.plot2,uce300.pis.plot2,uce1000.pis.plot2,uce.pis.plot2,
CDS.prop.plot2,uce100.prop.plot2,uce300.prop.plot2,uce1000.prop.plot2,uce.prop.plot2,
ncol = 5, nrow = 2)
pdf(file = "../../figs/Figure6b.pdf", width = 14, height = 7)
ggarrange(CDS.pis.plot2,uce100.pis.plot2,uce300.pis.plot2,uce1000.pis.plot2,uce.pis.plot2,
CDS.prop.plot2,uce100.prop.plot2,uce300.prop.plot2,uce1000.prop.plot2,uce.prop.plot2,
ncol = 5, nrow = 2)
dev.off()
