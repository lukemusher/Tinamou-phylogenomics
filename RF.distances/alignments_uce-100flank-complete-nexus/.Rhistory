chr.topos[26]<-F
tab<-data.frame(cbind(chr.lengths,chr.topos))
plot(tab$chr.lengths,tab$chr.topos)
library(aod)
library(ggplot2)
model <- glm(chr.topos ~ chr.lengths, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.lengths=(seq(min(tab$chr.lengths),max(tab$chr.lengths),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.lengths,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.lengths,newdata,lwd=2)
#fs <- read.fasta(file = "~/Dropbox/tham_for_greg/Tcae_B94639.pseudo.upper.masked.fasta")
chr.lengths<-log(getLength(fs)[c(1:26,28:35)])
getName(fs)[1:35]
chr.topos<-c(1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,1,1,1)
chr.topos<-chr.topos==1
chr.topos[26]<-F
tab<-data.frame(cbind(chr.lengths,chr.topos))
#fs <- read.fasta(file = "~/Dropbox/tham_for_greg/Tcae_B94639.pseudo.upper.masked.fasta")
chr.lengths<-log(getLength(fs)[c(1:26,28:35)])
getName(fs)[1:35]
chr.topos<-c(1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,1,0,1,1,1,1)
chr.topos<-chr.topos==0
chr.topos[26]<-T
tab<-data.frame(cbind(chr.lengths,chr.topos))
plot(tab$chr.lengths,tab$chr.topos)
library(aod)
library(ggplot2)
model <- glm(chr.topos ~ chr.lengths, data=tab, family = "binomial")
summary(model)
trees<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Thamno_aethio_200000bp_window_min5snps.tree_table.csv")
key<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Scaffold_names.csv")
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.length<-log(chr.length)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=log(chr.length),y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
e
exp(-0.13091)
chr.topos
chr.topos==F
chr.topos<-chr.topos==F
chr.length<-log(chr.length)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=log(chr.length),y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(2.2802) #0.8772967
library(ape)
library(phytools)
library(phangorn)
trees<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Thamno_aethio_200000bp_window_min5snps.tree_table.csv")
key<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Scaffold_names.csv")
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.topos<-chr.topos==F
#chr.length<-log(chr.length)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=log(chr.length),y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(2.2802) #0.8772967
#odds of outcome (Rondonia monophyly) will
#chr.length<-log(chr.length)
chr.length<-log(chr.length/1000)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
plot(chr.length,chr.topos)
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.topos<-chr.topos==F
#chr.length<-log(chr.length)
chr.length<-log(chr.length/1000)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(0.13091) #0.8772967
#odds of outcome (Rondonia monophyly) will
chr.length
trees<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Thamno_aethio_200000bp_window_min5snps.tree_table.csv")
key<-read.csv("~/Documents/ANSDU/thamnophilus/treeslider/Scaffold_names.csv")
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.topos<-chr.topos==F
#chr.length<-log(chr.length)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(0.13091) #0.8772967
#odds of outcome (Rondonia monophyly) will
chr.length
#chr.length<-log(chr.length)
chr.length<-chr.length/1000
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(2.110e-06) #0.8772967
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.topos<-chr.topos==F
#chr.length<-log(chr.length)
chr.length<-chr.length/1000000
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(2.110e-06) #0.8772967
#odds of outcome (Rondonia monophyly) will
exp(0.0021103) #0.8772967
counts=0
chr<-c()
chr.topos<-c()
chr.length<-c()
newick<-"(NoRond:1,(SoRond:1,(Inam:1,Puru:1)))"
species.tree<-root(read.tree(file = "~/Documents/ANSDU/thamnophilus/treeslider/ChrZ.tre"),"reference",resolve.root = T)
specTree<-drop.tip(species.tree,"reference")
plot(specTree)
for(i in 1:length(trees[,1])){
if(trees$tree[i]!=""){
counts=counts+1
chr[counts]<-key$scaffold_name[key$X==trees$scaffold[i]]
tree=read.newick(text=trees$tree[i])
tree<-root(phy=tree,outgroup = "reference",resolve.root = T)
tree<-drop.tip(phy = tree,tip = "reference")
chr.topos[counts]<-is.monophyletic(phy = tree,tips = c("NoRond","SoRond"))
#chr.topos[counts]=RF.dist(tree1 = specTree, tree2 = tree)
chr.length[counts]<-key$scaffold_length[key$scaffold_name==chr[counts]]
#write.tree(phy=tree, file = paste("~/Documents/ANSDU/thamnophilus/treeslider/genetrees/",chr,"tree",counts,".tre",sep = ""))
}
}
plot(chr.length,chr.topos)
chr.topos<-chr.topos==F
chr.length<-log(chr.length)
tab<-data.frame(cbind(chr.length,chr.topos))
model <- glm(chr.topos ~ chr.length, data=tab, family = "binomial")
summary(model)
newdata <- data.frame(chr.length=(seq(min(tab$chr.length),max(tab$chr.length),len=500)))
newdata$chr.topos<-predict(model, newdata, type="response")
plot(chr.length,chr.topos,data=tab,col="steelblue")
lines(chr.topos ~ chr.length,newdata,lwd=2)
ggplot(tab,aes(x=chr.length,y=chr.topos)) +
geom_point(alpha=0.5) +
stat_smooth(method="glm",se=FALSE, method.args = list(family=binomial))
exp(0.0021103) #0.8772967
#odds of outcome (Rondonia monophyly) will
exp(0.13091) #0.8772967
1.139865/(1+1.139865)
library(ggplot2)
library(gplots)
library(phytools)
library(ape)
library(phangorn)
library(ips)
library(ggpubr)
setwd("/Users/lukasmusher/Documents/ANSDU/Tinamous/RF.distances/CDS_complete_nexus/")
df.CDS<-read.csv("../CDS.csv")
uce.100.rax<-read.tree("../../Trees/UCE.100flank.crypt.raxml.boots.tre")
uce.100.ast<-read.tree("../../Trees/UCE.100flank.crypt.ASTRAL.PP.tre")
uce.300.rax<-read.tree("../../Trees/UCE.300flank.crypt.raxml.boots.tre")
uce.300.ast<-read.tree("../../Trees/UCE.300flank.crypt.ASTRAL.PP.tre")
uce.1000.rax<-read.tree("../../Trees/UCE.1000flank.crypt.raxml.boots.tre")
uce.1000.ast<-read.tree("../../Trees/UCEs.1000flank.crypt.ASTRAL.PP.tre")
cds.rax<-read.tree("../../Trees/CDS.crypt.raxml.boots.tre")
cds.ast<-read.tree("../../Trees/CDS.crypt.ASTRAL.PP.tre")
trees<-c(uce.100.rax,uce.100.ast,uce.300.rax,uce.300.ast,uce.1000.rax,uce.1000.ast,cds.rax,cds.ast)
trees.list<-c("uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast","cds.rax","cds.ast")
trees1<-c()
trees2<-c()
RF<-c()
count=0
trees1<-c()
trees2<-c()
RF<-c()
count=0
for (i in 1:8){
for (j in 1:4){
count=count+1
trees1[count]<-trees.list[i]
trees2[count]<-trees.list[j]
print(trees1[count])
print(trees2[count])
RF[count]<-RF.dist(tree1=trees[i][[1]],tree2=trees[j][[1]])
}
}
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab$trees1<-factor(trees1, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
tab$trees2<-factor(trees2, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
library(hrbrthemes)
ggplot(tab, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
trees1<-c()
trees2<-c()
RF<-c()
count=0
for (i in 1:8){
for (j in 1:8){
count=count+1
trees1[count]<-trees.list[i]
trees2[count]<-trees.list[j]
print(trees1[count])
print(trees2[count])
RF[count]<-RF.dist(tree1=trees[i][[1]],tree2=trees[j][[1]])
}
}
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab$trees1<-factor(trees1, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
tab$trees2<-factor(trees2, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
tab
df[!duplicated(lapply(strsplit(paste0(tab$trees1,tab$trees2),split = ''),sort)),]
tab[!duplicated(lapply(strsplit(paste0(tab$trees1,tab$trees2),split = ''),sort)),]
tab2<-tab[!duplicated(lapply(strsplit(paste0(tab$trees1,tab$trees2),split = ''),sort)),]
ggplot(tab2, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
tab2<-tab[!duplicated(lapply(strsplit(paste0(tab$trees1,tab$trees2),split = 'NA'),sort)),]
library(hrbrthemes)
ggplot(tab2, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
tab[!duplicated(lapply(strsplit(paste0(tab$trees1,tab$trees2),split = ''),sort)),]
tab
CorMat <- cor(tab[ ,c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
tab[ ,1
tab[ ,1]
tab[,1]
CorMat <- cor(tab[,c(trees1,trees2,)])
CorMat <- cor(tab[,c(trees1,trees2,RF)])
tab<-data.frame(trees1,trees2,as.numeric(RF))
tab<-data.frame(trees1,trees2,as.numeric(RF))
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
RF
as.numeric(RF)
data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab$trees1<-factor(trees1, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
tab$trees2<-factor(trees2, levels = c("cds.rax","cds.ast","uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast"))
library(hrbrthemes)
ggplot(tab2, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
ggcorrplot::ggcorrplot(cor(tab), type = "lower", lab = TRUE)
upper_tri2 <- get_upper_tri(round(cor(tab),2))
source("~/Documents/ANSDU/Tinamous/RF.distances/pis_rf_dist.R", echo=TRUE)
upper_tri2 <- get_upper_tri(round(tab,2))
library(MuSiC)
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab$trees1<-factor(trees1, levels = c("cds.rax","uce.100.rax","uce.300.rax","uce.1000.rax","cds.ast","uce.100.ast","uce.300.ast","uce.1000.ast"))
tab$trees2<-factor(trees2, levels = c("cds.rax","uce.100.rax","uce.300.rax","uce.1000.rax","cds.ast","uce.100.ast","uce.300.ast","uce.1000.ast"))
library(hrbrthemes)
ggplot(tab2, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
uce.100.rax<-read.tree("../../Trees/UCE.100flank.crypt.raxml.boots.tre")
uce.100.ast<-read.tree("../../Trees/UCE.100flank.crypt.ASTRAL.PP.tre")
gc()
uce.100.rax<-read.tree("../../Trees/UCE.100flank.crypt.raxml.boots.tre")
uce.100.ast<-read.tree("../../Trees/UCE.100flank.crypt.ASTRAL.PP.tre")
uce.100.rax<-read.tree("../../Trees/UCE.100flank.crypt.raxml.boots.tre")
uce.100.ast<-read.tree("../../Trees/UCE.100flank.crypt.ASTRAL.PP.tre")
uce.300.rax<-read.tree("../../Trees/UCE.300flank.crypt.raxml.boots.tre")
uce.300.ast<-read.tree("../../Trees/UCE.300flank.crypt.ASTRAL.PP.tre")
uce.1000.rax<-read.tree("../../Trees/UCE.1000flank.crypt.raxml.boots.tre")
uce.1000.ast<-read.tree("../../Trees/UCEs.1000flank.crypt.ASTRAL.PP.tre")
cds.rax<-read.tree("../../Trees/CDS.crypt.raxml.boots.tre")
cds.ast<-read.tree("../../Trees/CDS.crypt.ASTRAL.PP.tre")
trees<-c(uce.100.rax,uce.100.ast,uce.300.rax,uce.300.ast,uce.1000.rax,uce.1000.ast,cds.rax,cds.ast)
trees.list<-c("uce.100.rax","uce.100.ast","uce.300.rax","uce.300.ast","uce.1000.rax","uce.1000.ast","cds.rax","cds.ast")
trees1<-c()
trees2<-c()
RF<-c()
count=0
for (i in 1:8){
for (j in 1:8){
count=count+1
trees1[count]<-trees.list[i]
trees2[count]<-trees.list[j]
print(trees1[count])
print(trees2[count])
RF[count]<-RF.dist(tree1=trees[i][[1]],tree2=trees[j][[1]])
}
}
tab<-data.frame(cbind(trees1,trees2,as.numeric(RF)))
tab$trees1<-factor(trees1, levels = c("cds.rax","uce.100.rax","uce.300.rax","uce.1000.rax","cds.ast","uce.100.ast","uce.300.ast","uce.1000.ast"))
tab$trees2<-factor(trees2, levels = c("cds.rax","uce.100.rax","uce.300.rax","uce.1000.rax","cds.ast","uce.100.ast","uce.300.ast","uce.1000.ast"))
library(hrbrthemes)
ggplot(tab2, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
ggplot(tab, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_raster() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
ggplot(tab, aes(trees1, trees2, fill= as.numeric(RF))) +
geom_tile() +
scale_fill_gradient2(low = "steelblue3", high = "tomato3", mid = "ivory",
midpoint = max(RF)/2, limit = c(min(RF),max(RF)), space = "Lab",
name="RF Distance") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()+xlab("") + ylab("")+
geom_text(aes(trees1, trees2, label = RF), color = "black", size = 3) +
ggtitle(label = "Species Tree Differences for Crypt. Clade A")
